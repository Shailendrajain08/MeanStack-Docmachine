(this["webpackJsonpsketch-cloud-frontend"]=this["webpackJsonpsketch-cloud-frontend"]||[]).push([[0],{2337:function(e,n,t){"use strict";t.r(n),t.d(n,"default",(function(){return re}));var r,a,o,i,c,l,s,d,u,b,f,h,j,p,m,v,x=t(5),O=t(1),g=t.n(O),y=t(26),w=t(18),S=t(164),C=t(131),k=t(610),R=t(2),I=t(3),E=t(9),D=t(141),z=t(463),M=t(31),A=Object(I.default)(z.a)(r||(r=Object(R.a)(["\n  color: ",";\n"])),(function(e){return e.theme.colors.gray})),K=I.default.div(a||(a=Object(R.a)(["\n  display: flex;\n  flex-direction: column;\n  width: 100%;\n  padding: 12px 16px;\n  transition: background-color ",";\n\n  ",";\n\n  @media (hover: hover) {\n    &:hover .CommentDropdown {\n      opacity: 1;\n    }\n  }\n"])),(function(e){return e.theme.transitions.duration[2]}),(function(e){return e.isDeleting&&Object(I.css)(o||(o=Object(R.a)(["\n      background-color: #f7c7c8;\n      padding-top: 12px;\n    "])))})),T=I.default.div(i||(i=Object(R.a)(["\n  display: flex;\n  position: relative;\n"]))),U=I.default.span(c||(c=Object(R.a)(["\n  width: 5px;\n  height: 5px;\n  border-radius: 999px;\n  background-color: ",";\n  position: absolute;\n  top: calc(50% - 2px);\n  left: -13px;\n"])),(function(e){return e.theme.colors.orange})),B=I.default.div(l||(l=Object(R.a)(["\n  margin-right: 8px;\n  width: 32px;\n"]))),F=I.default.div(s||(s=Object(R.a)(["\n  width: 100%;\n  margin-top: 10px; /* stylelint-disable-line scales/space */\n"]))),N=Object(I.default)(D.a.H3)(d||(d=Object(R.a)(["\n  font-size: 0.8125rem;\n  max-width: 100%;\n  margin: 0;\n  line-height: 1.25;\n  ",";\n"])),M.d),V=I.default.div(u||(u=Object(R.a)(["\n  display: flex;\n  flex-direction: column;\n  overflow: hidden;\n"]))),H=I.default.span(b||(b=Object(R.a)(["\n  color: ",";\n  font-size: 0.75rem;\n  font-weight: ",";\n  display: flex;\n  align-items: center;\n"])),(function(e){return e.theme.colors.text.dark.secondary}),(function(e){return e.theme.fontWeights.regular})),J=I.default.div(f||(f=Object(R.a)(["\n  font-family: ",";\n  word-break: break-all;\n  word-break: break-word;\n  white-space: pre-wrap;\n  font-size: 0.8125rem;\n  line-height: 1.5;\n  border: none;\n  resize: none;\n\n  &:focus {\n    outline: 0;\n  }\n\n  p {\n    color: ",";\n  }\n\n  small {\n    color: ",";\n  }\n\n  a {\n    white-space: pre-wrap;\n  }\n"])),(function(e){return e.theme.fonts.body}),(function(e){return e.theme.colors.text.dark.primary}),(function(e){return e.theme.colors.text.dark.secondary})),L=I.default.div(h||(h=Object(R.a)(["\n  display: flex;\n  margin-top: 8px;\n  line-height: normal; /* stylelint-disable-line scales/line-height */\n"]))),W=Object(I.default)(E.FlatButton)(j||(j=Object(R.a)(["\n  display: flex;\n  font-size: 0.75rem;\n  padding: 0;\n  color: ",";\n  border: none;\n"])),(function(e){var n=e.theme;return"primary"!==e.variant&&n.colors.gray})),G=Object(I.default)(H)(p||(p=Object(R.a)(["\n  color: ",";\n  margin-left: 2px; /* stylelint-disable-line scales/space */\n"])),(function(e){return e.theme.colors.text.dark.tertiary})),P=Object(I.default)(w.c).withConfig({shouldForwardProp:function(e){return"visuallyShow"!==e}})(m||(m=Object(R.a)(["\n  margin-left: auto;\n  opacity: 0;\n\n  /* HACK: temporary fix for dropdown alignment */\n  line-height: 1;\n\n  ","\n"])),(function(e){return e.visuallyShow&&"\n    opacity: 1;\n  "})),Q=Object(I.default)(E.IconButton)(v||(v=Object(R.a)(["\n  line-height: 1;\n  padding: 0;\n  margin-top: -4px;\n\n  &,\n  :hover,\n  :active,\n  :focus {\n    border: none;\n    box-shadow: none;\n  }\n\n  :hover svg,\n  :focus svg,\n  :active svg {\n    color: ",";\n  }\n"])),(function(e){return e.theme.colors.text.dark.secondary})),q=t(649),X=t(13),Y=t(12),Z=t(490),$=t(6),_=t(0);var ee=function(e){var n,t,r=e.permanentArtboardShortId,a=e.shareIdentifier,o=e.value,i=e.inputRef,c=e.onChange,l=e.onSave,s=e.onCancel,d=Object(O.useState)(o),u=Object(x.a)(d,2),b=u[0],f=u[1],h=Object(O.useState)(o),j=Object(x.a)(h,2),p=j[0],m=j[1],v=Object(O.useState)(!1),y=Object(x.a)(v,2),w=y[0],S=y[1],C=g.a.createRef(),k=g.a.createRef();Object(O.useEffect)((function(){var e;C.current&&(C.current.focus(),(e=C.current).setSelectionRange&&e.value&&e.setSelectionRange(2*e.value.length,2*e.value.length)),k.current&&("scrollIntoViewIfNeeded"in Element.prototype?k.current.scrollIntoViewIfNeeded():k.current.scrollIntoView({block:"nearest",inline:"nearest"}))}),[]);var R=function(){b!==p?(S(!0),l(p).then((function(){S(!1),f(p),s()}))):s()},I=Object($.useGetArtboardMentionableUsersQuery)({variables:{permanentArtboardShortId:r,shareIdentifier:a}}).data,D=(null!==(n=null===I||void 0===I||null===(t=I.artboard)||void 0===t?void 0:t.mentionableUsers)&&void 0!==n?n:[]).map((function(e){var n;return{id:null===e||void 0===e?void 0:e.identifier,display:null===e||void 0===e?void 0:e.name,avatar:null===e||void 0===e||null===(n=e.avatar)||void 0===n?void 0:n.small}}));return Object(_.jsxs)("form",{ref:k,onSubmit:function(e){e.preventDefault(),R()},children:[Object(_.jsx)(Y.d,{mb:2,children:Object(_.jsx)(Z.a,{inputRef:i||C,padding:0,width:"100%",mentionableUsers:D,value:p,onSubmit:R,onChange:function(e){m(e.target.value),c&&c(e)},onKeyDown:function(e){var n=e.metaKey||e.ctrlKey,t=Z.c.getChangeByEventKey(e.key);if(n&&t){if(e.preventDefault(),C.current){var r=C.current,a=r.selectionStart,o=r.selectionEnd,i=Z.c.toggleTextWithChange(p,t,a,o),c=i.text,l=Object(X.a)(i,["text"]);m(c),C.current.setSelectionRange(l.selectionStart,l.selectionEnd)}}else;},onKeyUp:function(e){"Escape"===e.key&&s()}})}),Object(_.jsxs)(Y.b,{justifyContent:"flex-end",children:[Object(_.jsx)(E.default,{type:"button",disabled:w,small:!0,onClick:s,children:"Cancel"}),Object(_.jsx)(E.default,{"data-testid":"save-button",type:"submit",loading:w,small:!0,variant:"primary",children:"Save"})]})]})},ne=t(227),te=function(e){var n=e.repliesMeta,t=n.count,r=n.lastReplyDate;n.unread;return Object(_.jsxs)(_.Fragment,{children:[t," ",1===t?"Reply":"Replies","\xa0",Object(_.jsx)(G,{children:Object(_.jsx)(S.a,{short:!0,showShortDateSufix:!0,date:r})})]})},re=function(e){var n=e.identifier,t=e.repliesMeta,r=e.onEdit,a=e.onCancel,o=e.children,i=e.inputRef,c=e.isRead,l=e.isDeleting,s=e.userIsCreator,d=e.userCanDelete,u=e.meta,b=e.deleteComment,f=e.updateComment,h=e.isEdited,j=e.updatedAt,p=e.permanentArtboardShortId,m=e.shareIdentifier,v=e.onChange,g=e.onMouseEnter,R=e.onMouseLeave,I=Object(O.useRef)(c),E=Object(O.useState)(!1),D=Object(x.a)(E,2),z=D[0],M=D[1],G=Object(O.useState)(!1),X=Object(x.a)(G,2),Y=X[0],Z=X[1],$=Object(ne.a)(),re=$.createThreadRoute,ae=$.isThreadRoute,oe=function(e){M(e)};Object(O.useEffect)((function(){var e=null===i||void 0===i?void 0:i.current;Y&&e&&(e.focus(),e.selectionStart=e.selectionEnd=e.value.length)}),[Y,i]);var ie=function(){Z(!Y)},ce=function(){Z(!1),a&&a()},le=function(){r?r({toggleEditComment:ie,cancel:ce}):ie()};return Object(_.jsxs)(K,{id:n,isRead:c,isDeleting:l,onMouseEnter:g,onMouseLeave:R,children:[Object(_.jsxs)(T,{children:[!I.current&&Object(_.jsx)(U,{"data-testid":"unread-indicator"}),Object(_.jsx)(B,{children:Object(_.jsx)(C.a,{src:u.avatar,size:"32px",name:u.author})}),Object(_.jsxs)(V,{children:[Object(_.jsx)(N,{children:u.author}),Object(_.jsx)(H,{children:Object(_.jsx)(S.a,{short:!0,showShortDateSufix:!0,date:u.date})})]}),(s||d)&&Object(_.jsx)(q.a,{children:function(e){return Object(_.jsxs)(P,{className:"CommentDropdown",toggle:Object(_.jsx)(Q,{icon:A,size:"20px",buttonSize:"28px","data-testid":"comment-options"}),visuallyShow:z||e,onToggle:oe,placement:"bottom",children:[s&&Object(_.jsx)(w.c.Item,{onClick:le,children:"Edit Comment\u2026"}),d&&Object(_.jsx)(w.c.Item,{onClick:b,intent:"negative",children:"Delete Comment\u2026"})]})}})]}),Object(_.jsx)(F,{children:Y?Object(_.jsx)(ee,{inputRef:i,value:o,onSave:f,onCancel:ce,onChange:v,permanentArtboardShortId:p,shareIdentifier:m}):Object(_.jsxs)(J,{children:[Object(_.jsx)(k.a,{children:o}),h&&Object(_.jsx)("small",{title:j,children:"(Edited)"})]})}),!ae&&Object(_.jsx)(L,{children:Object(_.jsx)(y.a,{to:re(n),"data-testid":"reply-link",children:(null===t||void 0===t?void 0:t.count)?Object(_.jsx)(W,{children:Object(_.jsx)(te,{repliesMeta:t})}):Object(_.jsx)(W,{children:"Reply"})})})]})}}}]);
//# sourceMappingURL=0.921c12eb.chunk.js.map